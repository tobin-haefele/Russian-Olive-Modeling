---
title: "Russian_Olive_Modeling"
author: "Tobin Haefele"
date: "2025-01-28"
output: html_document
---

```{r setup, include=FALSE}
library(maxnet,warn.conflicts = FALSE)
library(readxl)
library(dplyr)
library(sf)
library(raster)
library(corrplot)
library(ggplot2)
library(tidymodels)
library(blockCV)
library(randomForest)

knitr::opts_chunk$set(echo = TRUE)
```

## Import data

```{r data import, warning=FALSE}
#import observations for missoula county field survey
survey.df <- read.csv("data/CombinedDataset.csv")

#import missoula county shapefile
msl_shape <- read_sf("data/MontanaStateBoundary_shp/MontanaCounties_shp"
)

msl_shape <- msl_shape %>% filter(NAME == "MISSOULA")
```

## Cleaning data
```{r data cleaning, echo=FALSE}
names(survey.df)

#remove spaces from column names
colnames(survey.df) <- gsub(" ", "_", colnames(survey.df))

msl_shape <- st_transform(msl_shape, crs = 4326)

# Convert survey.df to an sf object
survey_sf <- st_as_sf(survey.df, coords = c("Longitude", "Latitude"), crs = 4326)

```

## Testing cleaned data
```{r plot, echo=FALSE}

#plot imported points 
ggplot() +
  geom_sf(data = msl_shape) + 
  geom_sf(data=survey_sf)


```

## Prepping the data for modeling
```{r model prep, echo=FALSE}

set.seed(1234)

#split dataset into training/testing 
sb <- cv_spatial(survey_sf$PA)


```

## Basic modeling
```{r model, echo=FALSE}
# create correlation matrix
df.cor.climate <- st_drop_geometry(combined_df)
df.cor.climate <- na.omit(df.cor.climate)
climate.cor <- cor(df.cor.climate)

#view the correlation matrix
corrplot(climate.cor)

#create test model
mod1.LR <- glm(as.factor(pa) ~ bio1 + bio2 + bio3 + bio4 + bio5 + bio6 + bio7 + bio8 + bio9 + bio10 + bio11 + bio12 + bio13 + bio14 + bio15 + bio16 + bio17 + bio18 + bio19, data = combined_df, family = binomial)

#predict the model
mod1.pred <- predict(mod1.LR, type = "response")

#summarize the model
summary(mod1.LR)

```

### Potential Variables to include
- Wetland Riparian (land cover )
- Maximum Summer Temp (climate)
- Frost Free Days (climate)
- Anthropogenic Influence (land cover)
- Introduced Vegetation (land cover)
- Soil pH (soil)
- Forest - Conifer (land cover)
- Bulk Density (soil)
- Degree Days (climate)
-  Distance to Water Edge (hydrography)

### Data sets 
https://geoinfo.msl.mt.gov/msdi/land_use_land_cover
https://geoinfo.msl.mt.gov/msdi/climate/
https://prism.oregonstate.edu/
https://doi.org/10.18113/S1KW2H (soil)